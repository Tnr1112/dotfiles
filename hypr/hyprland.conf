# ╔══════════════════════════════════════════════════════════╗
# ║            HYPRLAND CONFIG — Tokyo Night Rice            ║
# ║         Máximas animaciones + blur + reglas               ║
# ╚══════════════════════════════════════════════════════════╝

# ───────────────────────── MONITOR ─────────────────────────
monitor = ,preferred,auto,1

# ────────────────────── AUTOSTART ───────────────────────────
exec-once = hyprpaper
exec-once = hypridle
exec-once = ags run ~/.config/ags/app.tsx
exec-once = wl-paste --type text  --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# ──────────────────── VARIABLES DE ENTORNO ──────────────────
env = XCURSOR_THEME,Bibata-Modern-Classic
env = XCURSOR_SIZE,24
env = QT_QPA_PLATFORMTHEME,qt5ct
env = QT_QPA_PLATFORM,wayland
env = GDK_BACKEND,wayland,x11
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

# ─────────────────────── APARIENCIA ─────────────────────────
general {
    gaps_in             = 5
    gaps_out            = 10
    border_size         = 2
    col.active_border   = rgba(7aa2f7ff) rgba(bb9af7ff) rgba(2ac3deff) 45deg
    col.inactive_border = rgba(292e42ff)
    resize_on_border    = true
    allow_tearing       = false
    layout              = dwindle
}

decoration {
    rounding        = 12
    rounding_power  = 2.0
    active_opacity  = 1.0
    inactive_opacity = 0.95

    shadow {
        enabled       = true
        range         = 20
        render_power  = 3
        color         = rgba(7aa2f720)
        color_inactive= rgba(00000010)
    }

    blur {
        enabled         = true
        size            = 8
        passes          = 3
        new_optimizations = true
        xray            = false
        noise           = 0.02
        contrast        = 1.0
        brightness      = 0.85
        vibrancy        = 0.17
        vibrancy_darkness = 0.0
        special         = true
        popups          = true
    }
}

# ──────────────────────── FUENTES ───────────────────────────
misc {
    font_family              = JetBrainsMono Nerd Font
    force_default_wallpaper  = 0
    disable_hyprland_logo    = true
    disable_splash_rendering = true
    mouse_move_enables_dpms  = true
    key_press_enables_dpms   = true
    animate_manual_resizes   = true
    animate_mouse_windowdragging = true
    enable_swallow           = true
    swallow_regex            = ^(kitty)$
    focus_on_activate        = false
}

# ──────────────────── ANIMACIONES ────────────────────────────
# Todas las curvas bezier personalizadas
bezier = overshot,      0.05, 0.9,  0.1,  1.1
bezier = smoothOut,     0.36, 0,    0.66, -0.56
bezier = smoothIn,      0.25, 1,    0.5,  1
bezier = linear,        0,    0,    1,    1
bezier = bounce,        0.68, -0.55, 0.27, 1.55
bezier = easeInOut,     0.4,  0,    0.2,  1
bezier = easeOut,       0,    0,    0.2,  1
bezier = snap,          0.075, 0.82, 0.165, 1

# ── Ventanas ──
animation = windows,        1, 4,  overshot,   slide
animation = windowsIn,      1, 4,  bounce,     popin 75%
animation = windowsOut,     1, 3,  smoothOut,  popin 90%
animation = windowsMove,    1, 3,  easeInOut,  slide

# ── Capas (launcher, notificaciones, etc.) ──
animation = layers,         1, 3,  easeOut,   slide
animation = layersIn,       1, 3,  easeOut,   slide
animation = layersOut,      1, 2,  smoothOut, fade

# ── Fade (todas las variantes disponibles en 0.54) ──
animation = fade,           1, 3,  linear
animation = fadeIn,         1, 3,  smoothIn
animation = fadeOut,        1, 2,  smoothOut
animation = fadeSwitch,     1, 2,  easeInOut
animation = fadeShadow,     1, 3,  linear
animation = fadeDim,        1, 3,  linear
animation = fadeLayers,     1, 3,  easeInOut
animation = fadePopups,     1, 2,  easeOut

# ── Borde animado (neón rotativo) ──
animation = border,         1, 6,  linear
# animation = borderangle,  1, 8,  linear, loop   ← descomenta para borde neón rotativo continuo (usa GPU constante)

# ── Workspaces ──
animation = workspaces,           1, 5,  overshot,   slidefade 20%
animation = workspacesIn,         1, 5,  overshot,   slidefade 20%
animation = workspacesOut,        1, 4,  smoothOut,  slidefade 20%
animation = specialWorkspace,     1, 4,  easeInOut,  slidevert
animation = specialWorkspaceIn,   1, 4,  easeOut,    slidevert
animation = specialWorkspaceOut,  1, 3,  smoothOut,  slidevert

# ── Monitor ──
animation = monitorAdded,   1, 5,  easeOut

# ──────────────────── INPUT ──────────────────────────────────
input {
    kb_layout   = es
    follow_mouse = 1
    sensitivity  = 0
    touchpad {
        natural_scroll   = true
        disable_while_typing = true
        tap-to-click     = true
        scroll_factor    = 0.8
    }
}

# gestures — workspace_swipe* fue removido en Hyprland 0.46+
# Los gestos táctiles ahora se configuran vía libinput directamente

# ────────────────────── LAYOUT ───────────────────────────────
dwindle {
    pseudotile          = true
    preserve_split      = true
    smart_resizing      = true
}

master {
    new_status          = master
    mfact               = 0.55
}

# ──────────────────── REGLAS DE VENTANA ──────────────────────
# Kitty: transparencia + blur via compositor
# windowrule v1: la regex coincide con la clase directamente (sin prefijo class:)
windowrule = opacity 0.92 0.88, ^(kitty)$
windowrule = rounding 12,       ^(kitty)$

# Flotantes con blur fuerte
windowrule = float,              ^(pavucontrol)$
windowrule = float,              ^(nm-connection-editor)$
windowrule = float,              ^(com.github.wwmm.easyeffects)$
windowrule = center,             ^(pavucontrol)$
windowrule = opacity 0.85 0.80,  ^(pavucontrol)$

# Diálogos siempre flotantes y centrados
# title-matching requiere windowrulev2
windowrulev2 = float,  title:^(Open File)$
windowrulev2 = float,  title:^(Save File)$
windowrulev2 = center, title:^(Open File)$
windowrulev2 = center, title:^(Save File)$

# AGS bar: sin animación de entrada (ya tiene la suya propia)
layerrule = noanim, ags-bar
layerrule = blur,   ags-bar

# Popup de clipboard: sin recorte de pantalla
layerrule = noanim, ags-clipboard
layerrule = blur,   ags-clipboard

# ──────────────────── KEYBINDS ───────────────────────────────
$mod = SUPER

# Aplicaciones principales
bind = $mod, Return,      exec, kitty
bind = $mod, E,           exec, nautilus
bind = $mod, B,           exec, firefox
bind = $mod SHIFT, Return,exec, kitty --class=floating-kitty

# Clipboard histórico
bind = $mod, V,           exec, ags toggle clipboard-popup

# Workspace launcher (AGS overlay launcher)
bind = $mod, D,           exec, ags toggle app-launcher

# Capturas de pantalla
bind = , Print,           exec, grim -g "$(slurp)" - | wl-copy
bind = SHIFT, Print,      exec, grim ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png

# Ventanas
bind = $mod, Q,           killactive
bind = $mod SHIFT, Q,     exit
bind = $mod, F,           fullscreen, 0
bind = $mod SHIFT, F,     fullscreen, 1
bind = $mod, P,           pseudo
bind = $mod, T,           togglesplit
bind = $mod, Space,       togglefloating

# Foco
bind = $mod, H,           movefocus, l
bind = $mod, L,           movefocus, r
bind = $mod, K,           movefocus, u
bind = $mod, J,           movefocus, d

# Mover ventanas
bind = $mod SHIFT, H,     movewindow, l
bind = $mod SHIFT, L,     movewindow, r
bind = $mod SHIFT, K,     movewindow, u
bind = $mod SHIFT, J,     movewindow, d

# Redimensionar
binde = $mod ALT, H,      resizeactive, -30 0
binde = $mod ALT, L,      resizeactive, 30  0
binde = $mod ALT, K,      resizeactive, 0  -30
binde = $mod ALT, J,      resizeactive, 0   30

# Workspaces 1–9
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9

bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, 5, movetoworkspace, 5
bind = $mod SHIFT, 6, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7
bind = $mod SHIFT, 8, movetoworkspace, 8
bind = $mod SHIFT, 9, movetoworkspace, 9

# Workspace especial (scratchpad)
bind = $mod, S,           togglespecialworkspace, magic
bind = $mod SHIFT, S,     movetoworkspace, special:magic

# Scroll en workspaces con rueda del ratón
bind = $mod, mouse_down,  workspace, e+1
bind = $mod, mouse_up,    workspace, e-1

# Mover ventana flotante con ratón
bindm = $mod, mouse:272,  movewindow
bindm = $mod, mouse:273,  resizewindow

# Audio
binde = , XF86AudioRaiseVolume,  exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
binde = , XF86AudioLowerVolume,  exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bind  = , XF86AudioMute,         exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bind  = , XF86AudioPlay,         exec, playerctl play-pause
bind  = , XF86AudioNext,         exec, playerctl next
bind  = , XF86AudioPrev,         exec, playerctl previous

# Brillo
binde = , XF86MonBrightnessUp,   exec, brightnessctl set 5%+
binde = , XF86MonBrightnessDown, exec, brightnessctl set 5%-

# Bloquear pantalla
bind = $mod, Escape,      exec, hyprlock

# Recargar AGS
bind = $mod SHIFT, R,     exec, ags quit; ags run ~/.config/ags/app.tsx
